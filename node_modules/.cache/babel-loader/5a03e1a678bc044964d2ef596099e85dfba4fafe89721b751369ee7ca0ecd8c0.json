{"ast":null,"code":"import _regeneratorRuntime from \"/Users/shane/Desktop/isc project/frontend/web-pos 3.0/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/shane/Desktop/isc project/frontend/web-pos 3.0/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/web.url.js\";\nimport \"core-js/modules/web.url.to-json.js\";\nimport \"core-js/modules/web.url-search-params.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport axios from \"axios\";\nimport { onMounted, ref } from \"vue\";\nimport { useRouter } from \"vue-router\";\nimport { useStore } from \"vuex\";\nexport default {\n  setup: function setup() {\n    var email = ref(\"\");\n    var router = useRouter();\n    var store = useStore();\n    var getAccessToken = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(code) {\n        var response, accessToken;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return axios.post(\"https://oauth2.googleapis.com/token\", {\n                code: code,\n                client_id: \"38181892421-dcmv3r9nvnkbalt85nskg16qtlc8e7n5.apps.googleusercontent.com\",\n                client_secret: \"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\",\n                redirect_uri: \"http://localhost:8020/redirect\",\n                grant_type: \"authorization_code\"\n              });\n            case 3:\n              response = _context.sent;\n              accessToken = response.data.access_token;\n              _context.next = 7;\n              return getUserInfo(accessToken);\n            case 7:\n              _context.next = 12;\n              break;\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](0);\n              console.error(\"Failed to exchange authorization code for access token:\", _context.t0);\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[0, 9]]);\n      }));\n      return function getAccessToken(_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n    var getUserInfo = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(accessToken) {\n        var response, userInfo, registerUser;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return axios.get(\"https://www.googleapis.com/oauth2/v1/userinfo?alt=json\", {\n                headers: {\n                  Authorization: \"Bearer \".concat(accessToken)\n                }\n              });\n            case 3:\n              response = _context2.sent;\n              userInfo = response.data;\n              console.log(\"User Info:\", userInfo);\n\n              // Call the oauth action with the user info\n              registerUser = {\n                firstname: userInfo.given_name,\n                lastname: userInfo.family_name,\n                show_name: userInfo.given_name,\n                email: userInfo.email,\n                password: \"N/A\"\n              };\n              _context2.next = 9;\n              return store.dispatch(\"auth/oauth\", registerUser);\n            case 9:\n              router.push(\"/dashboard\");\n              _context2.next = 15;\n              break;\n            case 12:\n              _context2.prev = 12;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.error(\"Failed to fetch user info:\", _context2.t0);\n            case 15:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, null, [[0, 12]]);\n      }));\n      return function getUserInfo(_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    onMounted(function () {\n      var code = new URL(window.location.href).searchParams.get(\"code\");\n      var state = new URL(window.location.href).searchParams.get(\"state\");\n      if (code && state) {\n        getAccessToken(code);\n      } else {\n        console.error(\"Authorization code or state missing.\");\n      }\n    });\n    return {\n      email: email\n    };\n  }\n};","map":{"version":3,"names":["axios","onMounted","ref","useRouter","useStore","setup","email","router","store","getAccessToken","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","code","response","accessToken","wrap","_callee$","_context","prev","next","post","client_id","client_secret","redirect_uri","grant_type","sent","data","access_token","getUserInfo","t0","console","error","stop","_x","apply","arguments","_ref2","_callee2","userInfo","registerUser","_callee2$","_context2","get","headers","Authorization","concat","log","firstname","given_name","lastname","family_name","show_name","password","dispatch","push","_x2","URL","window","location","href","searchParams","state"],"sources":["/Users/shane/Desktop/isc project/frontend/web-pos 3.0/src/views/auth/RedirectView.vue"],"sourcesContent":["<template>\n  <h1>Redirecting....</h1>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport { onMounted, ref } from \"vue\";\nimport { useRouter } from \"vue-router\";\nimport { useStore } from \"vuex\";\n\nexport default {\n  setup() {\n    const email = ref(\"\");\n    const router = useRouter();\n    const store = useStore();\n\n    const getAccessToken = async (code) => {\n      try {\n        const response = await axios.post(\"https://oauth2.googleapis.com/token\", {\n          code: code,\n          client_id: \"38181892421-dcmv3r9nvnkbalt85nskg16qtlc8e7n5.apps.googleusercontent.com\",\n          client_secret: \"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\",\n          redirect_uri: \"http://localhost:8020/redirect\",\n          grant_type: \"authorization_code\",\n        });\n\n        const accessToken = response.data.access_token;\n        await getUserInfo(accessToken);\n      } catch (error) {\n        console.error(\"Failed to exchange authorization code for access token:\", error);\n      }\n    };\n\n    const getUserInfo = async (accessToken) => {\n      try {\n        const response = await axios.get(\"https://www.googleapis.com/oauth2/v1/userinfo?alt=json\", {\n          headers: {\n            Authorization: `Bearer ${accessToken}`,\n          },\n        });\n\n        const userInfo = response.data;\n        console.log(\"User Info:\", userInfo);\n\n        // Call the oauth action with the user info\n        const registerUser = {\n          firstname: userInfo.given_name,\n          lastname: userInfo.family_name,\n          show_name: userInfo.given_name,\n          email: userInfo.email,\n          password: \"N/A\",\n        };\n        await store.dispatch(\"auth/oauth\", registerUser);\n\n        router.push(\"/dashboard\");\n      } catch (error) {\n        console.error(\"Failed to fetch user info:\", error);\n      }\n    };\n\n    onMounted(() => {\n      const code = new URL(window.location.href).searchParams.get(\"code\");\n      const state = new URL(window.location.href).searchParams.get(\"state\");\n\n      if (code && state) {\n        getAccessToken(code);\n      } else {\n        console.error(\"Authorization code or state missing.\");\n      }\n    });\n\n    return { email };\n  },\n};\n</script>\n\n<style></style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}