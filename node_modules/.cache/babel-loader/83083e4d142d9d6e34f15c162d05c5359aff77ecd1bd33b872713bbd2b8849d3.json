{"ast":null,"code":"import _regeneratorRuntime from \"/Users/shane/Desktop/isc project/frontend/web-pos 3.0/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/shane/Desktop/isc project/frontend/web-pos 3.0/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { computed, onMounted, ref } from \"vue\";\nimport { useStore } from \"vuex\";\nimport bootstrapBundle from 'bootstrap/dist/js/bootstrap.bundle';\nexport default {\n  emits: [\"toggleContent\"],\n  setup: function setup(props, _ref) {\n    var emit = _ref.emit;\n    var store = useStore();\n    var user = computed(function () {\n      return store.getters[\"auth/user\"];\n    });\n    var storeData = computed(function () {\n      return store.getters[\"auth/storeData\"];\n    });\n    var firstname = ref(user.value.firstname);\n    var lastname = ref(user.value.lastname);\n    var showName = ref(user.value.showName);\n    var password = ref(\"\");\n    var errorMsg = ref(\"\");\n    var toggleContent = function toggleContent() {\n      emit(\"toggleContent\");\n    };\n    var saveChanges = function saveChanges() {\n      var userChangeRequest = {\n        firstname: firstname.value,\n        lastname: lastname.value,\n        showName: showName.value\n      };\n      store.dispatch(\"user/updateUser\", userChangeRequest);\n      emit(\"toggleContent\");\n    };\n    var leaveStore = function leaveStore() {\n      store.dispatch(\"store/leaveStore\");\n    };\n    var deleteAccount = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var passwordRequest, validation, modalElement, modal;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              passwordRequest = {\n                password: password.value\n              };\n              _context.prev = 1;\n              _context.next = 4;\n              return store.dispatch(\"user/checkPassword\", passwordRequest);\n            case 4:\n              validation = _context.sent;\n              if (validation) {\n                errorMsg.value = \"\";\n                modalElement = document.getElementById(\"deleteAccountModal\");\n                modal = bootstrapBundle.Modal.getInstance(modalElement);\n                modal.hide();\n                store.dispatch(\"user/deleteUser\", passwordRequest);\n              } else {\n                password.value = \"\";\n                errorMsg.value = \"Incorrect password\";\n              }\n              _context.next = 12;\n              break;\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](1);\n              console.error(\"Error while checking password: \", _context.t0);\n              errorMsg.value = \"Error occurred while checking password\";\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[1, 8]]);\n      }));\n      return function deleteAccount() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    return {\n      user: user,\n      storeData: storeData,\n      toggleContent: toggleContent,\n      firstname: firstname,\n      lastname: lastname,\n      showName: showName,\n      saveChanges: saveChanges,\n      leaveStore: leaveStore,\n      password: password,\n      deleteAccount: deleteAccount,\n      errorMsg: errorMsg\n    };\n  }\n};","map":{"version":3,"names":["computed","onMounted","ref","useStore","bootstrapBundle","emits","setup","props","_ref","emit","store","user","getters","storeData","firstname","value","lastname","showName","password","errorMsg","toggleContent","saveChanges","userChangeRequest","dispatch","leaveStore","deleteAccount","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","passwordRequest","validation","modalElement","modal","wrap","_callee$","_context","prev","next","sent","document","getElementById","Modal","getInstance","hide","t0","console","error","stop","apply","arguments"],"sources":["/Users/shane/Desktop/isc project/frontend/web-pos 3.0/src/components/profile/ProfileEdit.vue"],"sourcesContent":["<template>\n  <div class=\"row justify-content-center\">\n    <div\n      class=\"col-6 col-md-4 m-4 d-flex justify-content-center align-items-center\"\n    >\n      <img src=\"@/assets/null-user.png\" class=\"rounded-4\" alt=\"\" />\n    </div>\n    <div class=\"col-8 col-md-6 m-5 mb-0\">\n      <div class=\"row text-start\">\n        <div class=\"col-6\">\n          <h6 class=\"text-secondary\">Firstname</h6>\n          <input\n            type=\"text\"\n            class=\"border border-secondary rounded-1\"\n            v-model=\"firstname\"\n            style=\"width: 95%\"\n          />\n        </div>\n        <div class=\"col-6\">\n          <h6 class=\"text-secondary\">Lastname</h6>\n          <input\n            type=\"text\"\n            class=\"border border-secondary rounded-1\"\n            v-model=\"lastname\"\n            style=\"width: 95%\"\n          />\n        </div>\n      </div>\n      <div class=\"text-start my-3\">\n        <h6 class=\"text-secondary\">Username</h6>\n        <input\n          type=\"text\"\n          class=\"border border-secondary rounded-1\"\n          v-model=\"showName\"\n          style=\"width: 95%\"\n        />\n      </div>\n      <div class=\"text-start my-3\">\n        <h6 class=\"text-secondary\">Email</h6>\n        <h5>{{ user.email }}</h5>\n      </div>\n      <div class=\"text-start my-3\">\n        <h6 class=\"text-secondary\">Store</h6>\n        <div class=\"d-flex align-items-center\" v-if=\"user.storeId\">\n          <h5 class=\"mb-0 me-3\">{{ storeData.name }}</h5>\n          <button\n            type=\"button\"\n            class=\"btn btn-danger\"\n            data-bs-toggle=\"modal\"\n            data-bs-target=\"#leavingStoreModal\"\n          >\n            Leave Store\n          </button>\n        </div>\n\n        <!-- Leaving Store Modal -->\n        <div\n          class=\"modal fade\"\n          id=\"leavingStoreModal\"\n          tabindex=\"-1\"\n          aria-labelledby=\"leavingStorelebal\"\n          aria-hidden=\"true\"\n        >\n          <div class=\"modal-dialog modal-dialog-centered\">\n            <div class=\"modal-content\">\n              <div class=\"modal-header\">\n                <h1 class=\"modal-title fs-5\" id=\"leavingStoreLabel\">\n                  Leaving Store\n                </h1>\n                <button\n                  type=\"button\"\n                  class=\"btn-close\"\n                  data-bs-dismiss=\"modal\"\n                  aria-label=\"Close\"\n                ></button>\n              </div>\n              <div class=\"modal-body\">\n                <h4>Are you sure?</h4>\n                <p>This process cannot be undone.</p>\n              </div>\n              <div class=\"modal-footer\">\n                <button\n                  type=\"button\"\n                  class=\"btn btn-secondary\"\n                  data-bs-dismiss=\"modal\"\n                >\n                  cancel\n                </button>\n                <button\n                  type=\"button\"\n                  class=\"btn btn-danger\"\n                  data-bs-dismiss=\"modal\"\n                  @click=\"leaveStore\"\n                >\n                  Yes, I'm sure.\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div v-if=\"!user.storeId\">\n          <h5>No Store</h5>\n          <a class=\"btn btn-lg btn-orange text-light\" href=\"/storeSetup\"\n            >Link to One Now</a\n          >\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <!-- Footer -->\n  <div class=\"row p-3\">\n    <div class=\"col-4 d-flex justify-content-start mb-4\">\n      <button\n        class=\"btn btn-danger text-light me-3\"\n        style=\"width: 9rem; height: 3rem\"\n        type=\"button\"\n        data-bs-toggle=\"modal\"\n        data-bs-target=\"#deleteAccountModal\"\n      >\n        Delete Account\n      </button>\n\n      <!-- Delete Account Modal -->\n      <div\n        class=\"modal fade\"\n        id=\"deleteAccountModal\"\n        tabindex=\"-1\"\n        aria-labelledby=\"deleteAccountModal\"\n        aria-hidden=\"true\"\n      >\n        <div class=\"modal-dialog modal-dialog-centered\">\n          <div class=\"modal-content\">\n            <div class=\"modal-header\">\n              <h1 class=\"modal-title fs-5\" id=\"deleteAccountLabel\">\n                Deleting Account\n              </h1>\n              <button\n                type=\"button\"\n                class=\"btn-close\"\n                data-bs-dismiss=\"modal\"\n                aria-label=\"Close\"\n              ></button>\n            </div>\n            <div class=\"modal-body\">\n              <h4>Are you sure?</h4>\n              <p>This process cannot be undone.</p>\n              <h5>Please Enter Your Password to Continue</h5>\n              <input\n                type=\"password\"\n                class=\"border border-secondary rounded-1\"\n                v-model=\"password\"\n                style=\"width: 95%; font-size: 20px\"\n                required\n              />\n              <p class=\"text-danger\">{{ errorMsg }}</p>\n            </div>\n            <div class=\"modal-footer\">\n              <button\n                type=\"button\"\n                class=\"btn btn-secondary\"\n                data-bs-dismiss=\"modal\"\n              >\n                cancel\n              </button>\n              <button\n                type=\"button\"\n                class=\"btn btn-danger\"\n                @click=\"deleteAccount\"\n              >\n                Delete Account\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"col-8 d-flex justify-content-end mb-4\">\n      <!-- Move the button to a new row and align it to the right -->\n      <button\n        class=\"btn btn-secondary text-light me-3\"\n        style=\"width: 9rem; height: 3rem\"\n        @click=\"toggleContent\"\n      >\n        Discard Changes\n      </button>\n      <button\n        class=\"btn btn-success text-light me-3\"\n        style=\"width: 9rem; height: 3rem\"\n        @click=\"saveChanges\"\n      >\n        Save Changes\n      </button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { computed, onMounted, ref } from \"vue\";\nimport { useStore } from \"vuex\";\nimport bootstrapBundle from 'bootstrap/dist/js/bootstrap.bundle';\nexport default {\n  emits: [\"toggleContent\"],\n  setup(props, { emit }) {\n    const store = useStore();\n    const user = computed(() => store.getters[\"auth/user\"]);\n    const storeData = computed(() => store.getters[\"auth/storeData\"]);\n    const firstname = ref(user.value.firstname);\n    const lastname = ref(user.value.lastname);\n    const showName = ref(user.value.showName);\n    const password = ref(\"\");\n    const errorMsg = ref(\"\");\n\n    const toggleContent = () => {\n      emit(\"toggleContent\");\n    };\n\n    const saveChanges = () => {\n      const userChangeRequest = {\n        firstname: firstname.value,\n        lastname: lastname.value,\n        showName: showName.value,\n      };\n      store.dispatch(\"user/updateUser\", userChangeRequest);\n      emit(\"toggleContent\");\n    };\n\n    const leaveStore = () => {\n      store.dispatch(\"store/leaveStore\");\n    };\n\n    const deleteAccount = async () => {\n      const passwordRequest = {\n        password: password.value,\n      };\n      try {\n        const validation = await store.dispatch(\n          \"user/checkPassword\",\n          passwordRequest\n        );\n        if (validation) {\n          errorMsg.value = \"\";\n          const modalElement = document.getElementById(\"deleteAccountModal\");\n          const modal = bootstrapBundle.Modal.getInstance(modalElement);\n          modal.hide();\n          store.dispatch(\"user/deleteUser\", passwordRequest);\n          \n        } else {\n          password.value = \"\";\n          errorMsg.value = \"Incorrect password\";\n        }\n      } catch (error) {\n        console.error(\"Error while checking password: \", error);\n        errorMsg.value = \"Error occurred while checking password\";\n      }\n    };\n\n    return {\n      user,\n      storeData,\n      toggleContent,\n      firstname,\n      lastname,\n      showName,\n      saveChanges,\n      leaveStore,\n      password,\n      deleteAccount,\n      errorMsg,\n    };\n  },\n};\n</script>\n\n<style scoped>\ninput {\n  font-size: 20px;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}